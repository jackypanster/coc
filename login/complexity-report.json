[{"filePath":"/Users/zhibinpan/workspace/coc/login/auth-manager.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'path' is assigned a value but never used.","line":1,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":11},{"ruleId":"no-unused-vars","severity":2,"message":"'crypto' is assigned a value but never used.","line":2,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":13},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":9,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":9,"endColumn":5,"fix":{"range":[118,122],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":10,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":10,"endColumn":9,"fix":{"range":[158,166],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":11,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":11,"endColumn":9,"fix":{"range":[200,208],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":12,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":12,"endColumn":9,"fix":{"range":[230,238],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":14,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":14,"endColumn":9,"fix":{"range":[322,330],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":15,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":15,"endColumn":9,"fix":{"range":[343,351],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":16,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":16,"endColumn":5,"fix":{"range":[379,383],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":18,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":18,"endColumn":5,"fix":{"range":[386,390],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":21,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":21,"endColumn":5,"fix":{"range":[418,422],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":22,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":22,"endColumn":9,"fix":{"range":[443,451],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":22,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":22,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[451,500],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":24,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":24,"endColumn":9,"fix":{"range":[510,518],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":25,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":25,"endColumn":13,"fix":{"range":[524,536],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":26,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":26,"endColumn":13,"fix":{"range":[549,561],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":27,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":27,"endColumn":13,"fix":{"range":[633,645],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":28,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":28,"endColumn":13,"fix":{"range":[682,694],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":30,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":30,"endColumn":13,"fix":{"range":[741,753],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":30,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":30,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[753,803],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":31,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":31,"endColumn":9,"fix":{"range":[804,812],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":32,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":32,"endColumn":13,"fix":{"range":[830,842],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[842,908],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":34,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":34,"endColumn":13,"fix":{"range":[922,934],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":35,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":35,"endColumn":13,"fix":{"range":[945,957],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":36,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":36,"endColumn":17,"fix":{"range":[994,1010],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":36,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":36,"endColumn":28,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1010,1039],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":37,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":37,"endColumn":17,"fix":{"range":[1040,1056],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":38,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":38,"endColumn":17,"fix":{"range":[1113,1129],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":39,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":39,"endColumn":17,"fix":{"range":[1166,1182],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":40,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":40,"endColumn":13,"fix":{"range":[1216,1228],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":41,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":41,"endColumn":17,"fix":{"range":[1237,1253],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":42,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":42,"endColumn":13,"fix":{"range":[1266,1278],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":43,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":43,"endColumn":9,"fix":{"range":[1280,1288],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":44,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":44,"endColumn":5,"fix":{"range":[1290,1294],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":46,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":46,"endColumn":5,"fix":{"range":[1297,1301],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":49,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":49,"endColumn":5,"fix":{"range":[1330,1334],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":50,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":50,"endColumn":9,"fix":{"range":[1354,1362],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":51,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":51,"endColumn":13,"fix":{"range":[1391,1403],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":52,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":52,"endColumn":17,"fix":{"range":[1409,1425],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":53,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":53,"endColumn":17,"fix":{"range":[1474,1490],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":54,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":54,"endColumn":13,"fix":{"range":[1506,1518],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":55,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":55,"endColumn":17,"fix":{"range":[1536,1552],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":55,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":55,"endColumn":30,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1552,1586],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":56,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":56,"endColumn":17,"fix":{"range":[1587,1603],"text":"        "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 500.","line":56,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":56,"endColumn":31},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":57,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":57,"endColumn":13,"fix":{"range":[1637,1649],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":58,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":58,"endColumn":9,"fix":{"range":[1651,1659],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":59,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":59,"endColumn":5,"fix":{"range":[1662,1666],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":61,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":61,"endColumn":5,"fix":{"range":[1669,1673],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":64,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":64,"endColumn":5,"fix":{"range":[1703,1707],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":65,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":65,"endColumn":9,"fix":{"range":[1728,1736],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":66,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":66,"endColumn":13,"fix":{"range":[1765,1777],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":67,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":67,"endColumn":17,"fix":{"range":[1783,1799],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":68,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":68,"endColumn":17,"fix":{"range":[1853,1869],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":69,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":69,"endColumn":13,"fix":{"range":[1887,1899],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":70,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":70,"endColumn":17,"fix":{"range":[1917,1933],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":70,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":70,"endColumn":30,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1933,1968],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":71,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":71,"endColumn":17,"fix":{"range":[1969,1985],"text":"        "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 500.","line":71,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":71,"endColumn":31},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":72,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":72,"endColumn":13,"fix":{"range":[2028,2040],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":73,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":73,"endColumn":9,"fix":{"range":[2042,2050],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":74,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":74,"endColumn":5,"fix":{"range":[2053,2057],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":76,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":76,"endColumn":5,"fix":{"range":[2060,2064],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":79,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":79,"endColumn":5,"fix":{"range":[2091,2095],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":80,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":80,"endColumn":9,"fix":{"range":[2114,2122],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":81,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":81,"endColumn":13,"fix":{"range":[2151,2163],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":82,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":82,"endColumn":17,"fix":{"range":[2169,2185],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":83,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":83,"endColumn":17,"fix":{"range":[2200,2216],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":85,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":85,"endColumn":17,"fix":{"range":[2294,2310],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":86,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":86,"endColumn":21,"fix":{"range":[2326,2346],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":87,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":87,"endColumn":21,"fix":{"range":[2354,2374],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":89,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":89,"endColumn":21,"fix":{"range":[2443,2463],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":90,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":90,"endColumn":21,"fix":{"range":[2477,2497],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 24.","line":91,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":91,"endColumn":25,"fix":{"range":[2530,2554],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 24.","line":92,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":92,"endColumn":25,"fix":{"range":[2570,2594],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 24.","line":93,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":93,"endColumn":25,"fix":{"range":[2611,2635],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 24.","line":94,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":94,"endColumn":25,"fix":{"range":[2666,2690],"text":"            "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":94,"column":42,"nodeType":"Property","messageId":"missing","endLine":95,"endColumn":1,"fix":{"range":[2698,2729],"text":"undefined,\n                    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":95,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":95,"endColumn":21,"fix":{"range":[2708,2728],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":97,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":97,"endColumn":21,"fix":{"range":[2753,2773],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":97,"column":21,"nodeType":"MemberExpression","messageId":"unexpected","endLine":97,"endColumn":32,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2773,2832],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":98,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":98,"endColumn":21,"fix":{"range":[2833,2853],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":99,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":99,"endColumn":17,"fix":{"range":[2930,2946],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":100,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":100,"endColumn":21,"fix":{"range":[2955,2975],"text":"          "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 401.","line":100,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":100,"endColumn":35},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":101,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":101,"endColumn":17,"fix":{"range":[3016,3032],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":102,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":102,"endColumn":13,"fix":{"range":[3034,3046],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":103,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":103,"endColumn":17,"fix":{"range":[3064,3080],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":103,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":103,"endColumn":30,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3080,3112],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":104,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":104,"endColumn":17,"fix":{"range":[3113,3129],"text":"        "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 401.","line":104,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":104,"endColumn":31},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":105,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":105,"endColumn":13,"fix":{"range":[3194,3206],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":106,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":106,"endColumn":9,"fix":{"range":[3208,3216],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":107,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":107,"endColumn":5,"fix":{"range":[3219,3223],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":109,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":109,"endColumn":5,"fix":{"range":[3226,3230],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":112,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":112,"endColumn":5,"fix":{"range":[3257,3261],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":113,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":113,"endColumn":9,"fix":{"range":[3279,3287],"text":"    "}},{"ruleId":"consistent-return","severity":2,"message":"Expected to return a value at the end of async arrow function.","line":113,"column":39,"nodeType":"ArrowFunctionExpression","messageId":"missingReturn","endLine":113,"endColumn":41},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":114,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":114,"endColumn":13,"fix":{"range":[3322,3334],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":115,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":115,"endColumn":13,"fix":{"range":[3346,3358],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":116,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":116,"endColumn":17,"fix":{"range":[3421,3437],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":117,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":117,"endColumn":13,"fix":{"range":[3452,3464],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":119,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":119,"endColumn":13,"fix":{"range":[3479,3491],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":121,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":121,"endColumn":13,"fix":{"range":[3540,3552],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":122,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":122,"endColumn":17,"fix":{"range":[3601,3617],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":124,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":124,"endColumn":17,"fix":{"range":[3680,3696],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":125,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":125,"endColumn":17,"fix":{"range":[3707,3723],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":127,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":127,"endColumn":17,"fix":{"range":[3802,3818],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":128,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":128,"endColumn":21,"fix":{"range":[3833,3853],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":129,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":129,"endColumn":21,"fix":{"range":[3865,3885],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":130,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":130,"endColumn":21,"fix":{"range":[3918,3938],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":131,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":131,"endColumn":21,"fix":{"range":[3963,3983],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":132,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":132,"endColumn":17,"fix":{"range":[3998,4014],"text":"        "}},{"ruleId":"no-else-return","severity":2,"message":"Unnecessary 'else' after 'return'.","line":132,"column":24,"nodeType":"BlockStatement","messageId":"unexpected","endLine":136,"endColumn":18,"fix":{"range":[3294,4342],"text":"async (req, res, next) => {\n            // 跳过登录相关路径\n            if (req.path === '/login' || req.path.startsWith('/login/')) {\n                return next();\n            }\n            \n            const sessionId = req.cookies.auth;\n            \n            if (sessionId && this.sessions.has(sessionId)) {\n                const session = this.sessions.get(sessionId);\n                \n                // 验证会话有效性\n                const isValid = await this.provider.validateSession(session);\n                \n                if (isValid) {\n                    // 更新最后访问时间\n                    session.lastAccess = Date.now();\n                    req.user = session.user;\n                    return next();\n                } \n                    // 会话过期\n                    console.log(`会话过期: ${session.user?.name || 'unknown'}`);\n                    this.sessions.delete(sessionId);\n                \n            }\n            \n            // 清除无效Cookie并重定向到登录页\n            res.clearCookie('auth');\n            res.redirect('/login');\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":133,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":133,"endColumn":21,"fix":{"range":[4023,4043],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":134,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":134,"endColumn":21,"fix":{"range":[4051,4071],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":134,"column":21,"nodeType":"MemberExpression","messageId":"unexpected","endLine":134,"endColumn":32,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4071,4127],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":135,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":135,"endColumn":21,"fix":{"range":[4128,4148],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":136,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":136,"endColumn":17,"fix":{"range":[4181,4197],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":137,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":137,"endColumn":13,"fix":{"range":[4199,4211],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":139,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":139,"endColumn":13,"fix":{"range":[4226,4238],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":140,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":140,"endColumn":13,"fix":{"range":[4260,4272],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":141,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":141,"endColumn":13,"fix":{"range":[4297,4309],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":142,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":142,"endColumn":9,"fix":{"range":[4333,4341],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":143,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":143,"endColumn":5,"fix":{"range":[4344,4348],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":145,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":145,"endColumn":5,"fix":{"range":[4351,4355],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":148,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":148,"endColumn":5,"fix":{"range":[4382,4386],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":149,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":149,"endColumn":9,"fix":{"range":[4407,4415],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":150,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":150,"endColumn":13,"fix":{"range":[4444,4456],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":13,"fix":{"range":[4505,4517],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":153,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":153,"endColumn":17,"fix":{"range":[4566,4582],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":155,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":155,"endColumn":17,"fix":{"range":[4645,4661],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":156,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":156,"endColumn":17,"fix":{"range":[4677,4693],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":158,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":158,"endColumn":17,"fix":{"range":[4747,4763],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":159,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":159,"endColumn":17,"fix":{"range":[4771,4787],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":160,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":160,"endColumn":13,"fix":{"range":[4820,4832],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":162,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":162,"endColumn":13,"fix":{"range":[4847,4859],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":163,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":163,"endColumn":13,"fix":{"range":[4884,4896],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":164,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":164,"endColumn":9,"fix":{"range":[4920,4928],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":165,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":165,"endColumn":5,"fix":{"range":[4931,4935],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":167,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":167,"endColumn":5,"fix":{"range":[4938,4942],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":5,"fix":{"range":[4975,4979],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":171,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":171,"endColumn":9,"fix":{"range":[5001,5009],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":172,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":172,"endColumn":5,"fix":{"range":[5064,5068],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":174,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":174,"endColumn":5,"fix":{"range":[5071,5075],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":177,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":177,"endColumn":5,"fix":{"range":[5099,5103],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":178,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":178,"endColumn":9,"fix":{"range":[5129,5137],"text":"    "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 36.","line":178,"column":74,"nodeType":"Literal","messageId":"noMagic","endLine":178,"endColumn":76},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":179,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":179,"endColumn":9,"fix":{"range":[5207,5215],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":181,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":181,"endColumn":9,"fix":{"range":[5248,5256],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":13,"fix":{"range":[5287,5299],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":183,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":183,"endColumn":13,"fix":{"range":[5315,5327],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":184,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":184,"endColumn":13,"fix":{"range":[5344,5356],"text":"      "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":184,"column":27,"nodeType":"Property","messageId":"missing","endLine":185,"endColumn":1,"fix":{"range":[5362,5380],"text":"userInfo,\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":185,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":185,"endColumn":9,"fix":{"range":[5371,5379],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":187,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":187,"endColumn":9,"fix":{"range":[5392,5400],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":188,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":188,"endColumn":5,"fix":{"range":[5418,5422],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":190,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":190,"endColumn":5,"fix":{"range":[5425,5429],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":193,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":193,"endColumn":5,"fix":{"range":[5458,5462],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":194,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":194,"endColumn":9,"fix":{"range":[5486,5494],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":195,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":195,"endColumn":13,"fix":{"range":[5520,5532],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":197,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":197,"endColumn":13,"fix":{"range":[5567,5579],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":198,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":198,"endColumn":17,"fix":{"range":[5641,5657],"text":"        "}},{"ruleId":"no-await-in-loop","severity":1,"message":"Unexpected `await` inside a loop.","line":198,"column":33,"nodeType":"AwaitExpression","messageId":"unexpectedAwait","endLine":198,"endColumn":77},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":200,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":200,"endColumn":17,"fix":{"range":[5736,5752],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":201,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":201,"endColumn":21,"fix":{"range":[5768,5788],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":202,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":202,"endColumn":21,"fix":{"range":[5821,5841],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":203,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":203,"endColumn":17,"fix":{"range":[5857,5873],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":204,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":204,"endColumn":13,"fix":{"range":[5875,5887],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":206,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":206,"endColumn":13,"fix":{"range":[5902,5914],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":207,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":207,"endColumn":17,"fix":{"range":[5938,5954],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":207,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":207,"endColumn":28,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[5954,5998],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":208,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":208,"endColumn":13,"fix":{"range":[5999,6011],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":209,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":209,"endColumn":9,"fix":{"range":[6013,6021],"text":"    "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 30.","line":209,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":209,"endColumn":14},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":209,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":209,"endColumn":19},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":210,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":210,"endColumn":5,"fix":{"range":[6049,6053],"text":"  "}}],"suppressedMessages":[],"errorCount":160,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":157,"fixableWarningCount":0,"source":"const path = require('path');\nconst crypto = require('crypto');\n\n/**\n * 认证管理器\n * 负责加载和管理认证提供者\n */\nclass AuthManager {\n    constructor(providerType = 'sso') {\n        this.providerType = providerType;\n        this.provider = null;\n        this.sessions = new Map(); // sessionId -> { createdAt, lastAccess, user }\n        \n        // 启动会话清理定时器\n        this.startSessionCleanup();\n    }\n\n    /**\n     * 初始化认证提供者\n     */\n    async initialize() {\n        console.log(`🔐 初始化认证提供者: ${this.providerType}`);\n        \n        try {\n            // 动态加载认证提供者\n            const ProviderClass = require(`./auth-providers/${this.providerType}`);\n            this.provider = new ProviderClass();\n            await this.provider.initialize();\n            \n            console.log(`✅ 认证提供者 ${this.providerType} 初始化成功`);\n        } catch (error) {\n            console.error(`❌ 无法加载认证提供者 ${this.providerType}:`, error.message);\n            \n            // 降级到本地认证\n            if (this.providerType !== 'local') {\n                console.log('⚠️  降级到本地认证模式');\n                const LocalProvider = require('./auth-providers/local');\n                this.provider = new LocalProvider();\n                await this.provider.initialize();\n            } else {\n                throw error;\n            }\n        }\n    }\n\n    /**\n     * 获取登录页面处理器\n     */\n    getLoginHandler() {\n        return async (req, res) => {\n            try {\n                const html = await this.provider.getLoginPage();\n                res.send(html);\n            } catch (error) {\n                console.error('获取登录页面失败:', error);\n                res.status(500).send('登录页面加载失败');\n            }\n        };\n    }\n\n    /**\n     * 获取客户端配置处理器\n     */\n    getConfigHandler() {\n        return async (req, res) => {\n            try {\n                const config = await this.provider.getClientConfig();\n                res.json(config);\n            } catch (error) {\n                console.error('获取客户端配置失败:', error);\n                res.status(500).json({ error: '配置加载失败' });\n            }\n        };\n    }\n\n    /**\n     * 获取认证处理器\n     */\n    getAuthHandler() {\n        return async (req, res) => {\n            try {\n                // 调用认证提供者进行认证\n                const userInfo = await this.provider.authenticate(req, res);\n                \n                if (userInfo) {\n                    // 创建会话\n                    const sessionId = this.createSession(userInfo);\n                    \n                    // 设置会话Cookie\n                    res.cookie('auth', sessionId, { \n                        httpOnly: true,\n                        sameSite: 'lax',\n                        secure: false, // 生产环境应设置为true\n                        domain: undefined\n                    });\n                    \n                    console.log(`✅ 用户 ${userInfo.name} (${userInfo.id}) 登录成功`);\n                    res.json({ success: true, user: { name: userInfo.name, id: userInfo.id } });\n                } else {\n                    res.status(401).json({ error: '认证失败' });\n                }\n            } catch (error) {\n                console.error('认证处理失败:', error);\n                res.status(401).json({ error: '认证失败', details: error.message });\n            }\n        };\n    }\n\n    /**\n     * 获取认证中间件\n     */\n    getMiddleware() {\n        return async (req, res, next) => {\n            // 跳过登录相关路径\n            if (req.path === '/login' || req.path.startsWith('/login/')) {\n                return next();\n            }\n            \n            const sessionId = req.cookies.auth;\n            \n            if (sessionId && this.sessions.has(sessionId)) {\n                const session = this.sessions.get(sessionId);\n                \n                // 验证会话有效性\n                const isValid = await this.provider.validateSession(session);\n                \n                if (isValid) {\n                    // 更新最后访问时间\n                    session.lastAccess = Date.now();\n                    req.user = session.user;\n                    return next();\n                } else {\n                    // 会话过期\n                    console.log(`会话过期: ${session.user?.name || 'unknown'}`);\n                    this.sessions.delete(sessionId);\n                }\n            }\n            \n            // 清除无效Cookie并重定向到登录页\n            res.clearCookie('auth');\n            res.redirect('/login');\n        };\n    }\n\n    /**\n     * 获取登出处理器\n     */\n    getLogoutHandler() {\n        return async (req, res) => {\n            const sessionId = req.cookies.auth;\n            \n            if (sessionId && this.sessions.has(sessionId)) {\n                const session = this.sessions.get(sessionId);\n                \n                // 调用认证提供者的登出方法\n                await this.provider.logout(session);\n                \n                // 删除会话\n                this.sessions.delete(sessionId);\n            }\n            \n            res.clearCookie('auth');\n            res.redirect('/login');\n        };\n    }\n\n    /**\n     * 获取认证提供者的自定义路由\n     */\n    getProviderRoutes() {\n        return this.provider ? this.provider.getRoutes() : [];\n    }\n\n    /**\n     * 创建会话\n     */\n    createSession(userInfo) {\n        const sessionId = Date.now().toString() + Math.random().toString(36);\n        const now = Date.now();\n        \n        this.sessions.set(sessionId, {\n            createdAt: now,\n            lastAccess: now,\n            user: userInfo\n        });\n        \n        return sessionId;\n    }\n\n    /**\n     * 启动会话清理定时器\n     */\n    startSessionCleanup() {\n        setInterval(async () => {\n            let cleanedCount = 0;\n            \n            for (const [sessionId, session] of this.sessions.entries()) {\n                const isValid = await this.provider.validateSession(session);\n                \n                if (!isValid) {\n                    this.sessions.delete(sessionId);\n                    cleanedCount++;\n                }\n            }\n            \n            if (cleanedCount > 0) {\n                console.log(`🧹 清理了 ${cleanedCount} 个过期会话`);\n            }\n        }, 30 * 60 * 1000); // 30分钟\n    }\n}\n\nmodule.exports = AuthManager;","usedDeprecatedRules":[{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/zhibinpan/workspace/coc/login/auth-provider.js","messages":[{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":6,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":6,"endColumn":5,"fix":{"range":[66,70],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":7,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":7,"endColumn":9,"fix":{"range":[97,105],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":8,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":8,"endColumn":5,"fix":{"range":[127,131],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":10,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":10,"endColumn":5,"fix":{"range":[134,138],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":14,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":14,"endColumn":5,"fix":{"range":[211,215],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":15,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":15,"endColumn":9,"fix":{"range":[238,246],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":16,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":16,"endColumn":5,"fix":{"range":[313,317],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":18,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":18,"endColumn":5,"fix":{"range":[320,324],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":22,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":22,"endColumn":5,"fix":{"range":[403,407],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":23,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":23,"endColumn":9,"fix":{"range":[433,441],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":24,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":24,"endColumn":5,"fix":{"range":[452,456],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":26,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":26,"endColumn":5,"fix":{"range":[459,463],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":32,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":32,"endColumn":5,"fix":{"range":[628,632],"text":"  "}},{"ruleId":"no-unused-vars","severity":2,"message":"'req' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":32},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":33,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":33,"endColumn":9,"fix":{"range":[663,671],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":34,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":34,"endColumn":5,"fix":{"range":[738,742],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":36,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":36,"endColumn":5,"fix":{"range":[745,749],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":41,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":41,"endColumn":5,"fix":{"range":[855,859],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":42,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":42,"endColumn":9,"fix":{"range":[892,900],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":43,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":43,"endColumn":9,"fix":{"range":[924,932],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":9,"fix":{"range":[969,977],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":46,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":46,"endColumn":9,"fix":{"range":[1031,1039],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":47,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":47,"endColumn":9,"fix":{"range":[1049,1057],"text":"    "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 12.","line":47,"column":47,"nodeType":"Literal","messageId":"noMagic","endLine":47,"endColumn":49},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":47,"column":52,"nodeType":"Literal","messageId":"noMagic","endLine":47,"endColumn":54},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":47,"column":57,"nodeType":"Literal","messageId":"noMagic","endLine":47,"endColumn":59},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":48,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":48,"endColumn":9,"fix":{"range":[1124,1132],"text":"    "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":48,"column":61,"nodeType":"Literal","messageId":"noMagic","endLine":48,"endColumn":63},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":48,"column":66,"nodeType":"Literal","messageId":"noMagic","endLine":48,"endColumn":68},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":50,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":50,"endColumn":9,"fix":{"range":[1216,1224],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":51,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":51,"endColumn":5,"fix":{"range":[1279,1283],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":53,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":53,"endColumn":5,"fix":{"range":[1286,1290],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":58,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":58,"endColumn":5,"fix":{"range":[1384,1388],"text":"  "}},{"ruleId":"no-unused-vars","severity":2,"message":"'session' is defined but never used. Allowed unused args must match /^_/u.","line":58,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":25},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":59,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":59,"endColumn":9,"fix":{"range":[1412,1420],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":60,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":60,"endColumn":5,"fix":{"range":[1435,1439],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":62,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":62,"endColumn":5,"fix":{"range":[1442,1446],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":66,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":66,"endColumn":5,"fix":{"range":[1520,1524],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":67,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":67,"endColumn":9,"fix":{"range":[1538,1546],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":68,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":68,"endColumn":5,"fix":{"range":[1557,1561],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":70,"column":1,"nodeType":"Block","messageId":"wrongIndentation","endLine":70,"endColumn":5,"fix":{"range":[1564,1568],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":5,"fix":{"range":[1628,1632],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":75,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":75,"endColumn":9,"fix":{"range":[1653,1661],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":76,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":76,"endColumn":5,"fix":{"range":[1675,1679],"text":"  "}}],"suppressedMessages":[],"errorCount":40,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":37,"fixableWarningCount":0,"source":"/**\n * 认证提供者接口基类\n * 所有认证实现都应该继承此类并实现相应方法\n */\nclass AuthProvider {\n    constructor(config = {}) {\n        this.config = config;\n    }\n\n    /**\n     * 获取登录页面HTML内容\n     * @returns {Promise<string>} HTML内容\n     */\n    async getLoginPage() {\n        throw new Error('getLoginPage() must be implemented by subclass');\n    }\n\n    /**\n     * 获取前端需要的配置信息（不包含敏感数据）\n     * @returns {Promise<Object>} 配置对象\n     */\n    async getClientConfig() {\n        return {};\n    }\n\n    /**\n     * 处理认证请求\n     * @param {Object} req - Express请求对象\n     * @param {Object} res - Express响应对象\n     * @returns {Promise<Object|null>} 成功返回用户信息，失败返回null\n     */\n    async authenticate(req, res) {\n        throw new Error('authenticate() must be implemented by subclass');\n    }\n\n    /**\n     * 验证会话是否有效\n     * @param {Object} session - 会话数据\n     * @returns {Promise<boolean>} 是否有效\n     */\n    async validateSession(session) {\n        const now = Date.now();\n        const age = now - session.createdAt;\n        const inactivity = now - session.lastAccess;\n        \n        // 默认会话策略\n        const MAX_AGE = this.config.maxAge || 12 * 60 * 60 * 1000; // 12小时\n        const MAX_INACTIVITY = this.config.maxInactivity || 60 * 60 * 1000; // 1小时\n        \n        return age <= MAX_AGE && inactivity <= MAX_INACTIVITY;\n    }\n\n    /**\n     * 处理登出\n     * @param {Object} session - 会话数据\n     * @returns {Promise<void>}\n     */\n    async logout(session) {\n        // 默认实现：无需特殊处理\n    }\n\n    /**\n     * 获取认证路由配置\n     * @returns {Array<Object>} Express路由配置数组\n     */\n    getRoutes() {\n        return [];\n    }\n\n    /**\n     * 初始化认证提供者\n     * @returns {Promise<void>}\n     */\n    async initialize() {\n        // 默认实现：无需初始化\n    }\n}\n\nmodule.exports = AuthProvider;","usedDeprecatedRules":[{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/zhibinpan/workspace/coc/login/auth-providers/local/index.js","messages":[{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":10,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":10,"endColumn":5,"fix":{"range":[206,210],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":11,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":11,"endColumn":9,"fix":{"range":[226,234],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":12,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":12,"endColumn":13,"fix":{"range":[242,254],"text":"      "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 24.","line":12,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":12,"endColumn":23},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":12,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":12,"endColumn":28},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":12,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":12,"endColumn":33},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":13,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":13,"endColumn":13,"fix":{"range":[305,317],"text":"      "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 4.","line":13,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":13,"endColumn":29},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":13,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":13,"endColumn":34},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":13,"column":37,"nodeType":"Literal","messageId":"noMagic","endLine":13,"endColumn":39},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":13,"column":46,"nodeType":"Property","messageId":"missing","endLine":13,"endColumn":47,"fix":{"range":[346,368],"text":"1000,  // 4小时\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":14,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":14,"endColumn":9,"fix":{"range":[359,367],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":15,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":15,"endColumn":5,"fix":{"range":[371,375],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":17,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":17,"endColumn":5,"fix":{"range":[378,382],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":18,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":18,"endColumn":9,"fix":{"range":[403,411],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":18,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":18,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[411,441],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":19,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":19,"endColumn":9,"fix":{"range":[442,450],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":19,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":19,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[450,496],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":20,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":20,"endColumn":5,"fix":{"range":[497,501],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":22,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":22,"endColumn":5,"fix":{"range":[504,508],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":23,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":23,"endColumn":9,"fix":{"range":[531,539],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":24,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":24,"endColumn":9,"fix":{"range":[593,601],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":25,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":25,"endColumn":5,"fix":{"range":[647,651],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":27,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":27,"endColumn":5,"fix":{"range":[654,658],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":28,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":28,"endColumn":9,"fix":{"range":[684,692],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":29,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":29,"endColumn":13,"fix":{"range":[701,713],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":30,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":30,"endColumn":13,"fix":{"range":[728,740],"text":"      "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":30,"column":40,"nodeType":"Property","messageId":"missing","endLine":31,"endColumn":1,"fix":{"range":[749,777],"text":"'开发模式：使用任意用户名密码登录',\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":31,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":31,"endColumn":9,"fix":{"range":[768,776],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":32,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":32,"endColumn":5,"fix":{"range":[779,783],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":34,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":34,"endColumn":5,"fix":{"range":[786,790],"text":"  "}},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":34,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":32},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":35,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":35,"endColumn":9,"fix":{"range":[821,829],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":37,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":37,"endColumn":9,"fix":{"range":[879,887],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":38,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":38,"endColumn":13,"fix":{"range":[917,929],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":39,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":39,"endColumn":9,"fix":{"range":[960,968],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":41,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":41,"endColumn":9,"fix":{"range":[979,987],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":42,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":42,"endColumn":9,"fix":{"range":[1008,1016],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":42,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":42,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1016,1058],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":9,"fix":{"range":[1068,1076],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":45,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":45,"endColumn":13,"fix":{"range":[1085,1097],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":46,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":46,"endColumn":13,"fix":{"range":[1122,1134],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":47,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":47,"endColumn":13,"fix":{"range":[1150,1162],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":48,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":48,"endColumn":13,"fix":{"range":[1194,1206],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":49,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":49,"endColumn":13,"fix":{"range":[1233,1245],"text":"      "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":49,"column":26,"nodeType":"Property","messageId":"missing","endLine":50,"endColumn":1,"fix":{"range":[1251,1268],"text":"'local',\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":50,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":50,"endColumn":9,"fix":{"range":[1259,1267],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":51,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":51,"endColumn":5,"fix":{"range":[1270,1274],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":53,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":53,"endColumn":5,"fix":{"range":[1277,1281],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":9,"fix":{"range":[1295,1303],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":55,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":55,"endColumn":13,"fix":{"range":[1312,1324],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":56,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":56,"endColumn":17,"fix":{"range":[1326,1342],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":57,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":57,"endColumn":17,"fix":{"range":[1358,1374],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":58,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":58,"endColumn":17,"fix":{"range":[1396,1412],"text":"        "}},{"ruleId":"no-unused-vars","severity":2,"message":"'req' is defined but never used. Allowed unused args must match /^_/u.","line":58,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":36},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":58,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":41},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":59,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":59,"endColumn":21,"fix":{"range":[1443,1463],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":60,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":60,"endColumn":17,"fix":{"range":[1494,1510],"text":"        "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":60,"column":18,"nodeType":"Property","messageId":"missing","endLine":61,"endColumn":1,"fix":{"range":[1510,1525],"text":"},\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":61,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":61,"endColumn":13,"fix":{"range":[1512,1524],"text":"      "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":61,"column":14,"nodeType":"ObjectExpression","messageId":"missing","endLine":62,"endColumn":1,"fix":{"range":[1524,1535],"text":"},\n        ]"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":62,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":62,"endColumn":9,"fix":{"range":[1526,1534],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":63,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":63,"endColumn":5,"fix":{"range":[1537,1541],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":65,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":65,"endColumn":5,"fix":{"range":[1544,1548],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":66,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":66,"endColumn":9,"fix":{"range":[1581,1589],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":67,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":67,"endColumn":9,"fix":{"range":[1604,1612],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":69,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":69,"endColumn":9,"fix":{"range":[1675,1683],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":70,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":70,"endColumn":13,"fix":{"range":[1733,1745],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":70,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":70,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1745,1793],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":71,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":71,"endColumn":9,"fix":{"range":[1794,1802],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":73,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":73,"endColumn":9,"fix":{"range":[1813,1821],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":74,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":74,"endColumn":5,"fix":{"range":[1837,1841],"text":"  "}}],"suppressedMessages":[],"errorCount":62,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":59,"fixableWarningCount":0,"source":"const path = require('path');\nconst fs = require('fs').promises;\nconst AuthProvider = require('../../auth-provider');\n\n/**\n * 本地开发认证提供者\n * 用于开发环境，不需要真实的认证\n */\nclass LocalAuthProvider extends AuthProvider {\n    constructor() {\n        super({\n            maxAge: 24 * 60 * 60 * 1000,      // 24小时（开发环境更宽松）\n            maxInactivity: 4 * 60 * 60 * 1000  // 4小时\n        });\n    }\n\n    async initialize() {\n        console.log('🔧 本地开发认证模式已启用');\n        console.log('⚠️  警告：此模式仅用于开发环境，生产环境请使用SSO认证');\n    }\n\n    async getLoginPage() {\n        const loginPath = path.join(__dirname, 'login.html');\n        return await fs.readFile(loginPath, 'utf-8');\n    }\n\n    async getClientConfig() {\n        return {\n            mode: 'local',\n            message: '开发模式：使用任意用户名密码登录'\n        };\n    }\n\n    async authenticate(req, res) {\n        const { username, password } = req.body;\n        \n        if (!username || !password) {\n            throw new Error('用户名和密码不能为空');\n        }\n        \n        // 开发模式：接受任何非空的用户名密码\n        console.log(`🔓 本地认证: 用户 ${username} 登录`);\n        \n        return {\n            id: `local_${username}`,\n            name: username,\n            email: `${username}@local.dev`,\n            department: 'Development',\n            type: 'local'\n        };\n    }\n\n    getRoutes() {\n        return [\n            {\n                method: 'post',\n                path: '/login/local',\n                handler: async (req, res) => {\n                    // 本地认证由AuthManager统一处理，这里只是占位\n                }\n            }\n        ];\n    }\n\n    async validateSession(session) {\n        // 调用父类的默认验证逻辑\n        const isValid = await super.validateSession(session);\n        \n        if (!isValid && session.user?.type === 'local') {\n            console.log(`⏰ 本地开发会话过期: ${session.user.name}`);\n        }\n        \n        return isValid;\n    }\n}\n\nmodule.exports = LocalAuthProvider;","usedDeprecatedRules":[{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/zhibinpan/workspace/coc/login/auth-providers/sso/index.js","messages":[{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":11,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":11,"endColumn":5,"fix":{"range":[243,247],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":12,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":12,"endColumn":9,"fix":{"range":[263,271],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":13,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":13,"endColumn":13,"fix":{"range":[279,291],"text":"      "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 12.","line":13,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":13,"endColumn":23},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":13,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":13,"endColumn":28},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":13,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":13,"endColumn":33},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":14,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":14,"endColumn":13,"fix":{"range":[333,345],"text":"      "}},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":14,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":14,"endColumn":30},{"ruleId":"no-magic-numbers","severity":1,"message":"No magic number: 60.","line":14,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":14,"endColumn":35},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":14,"column":42,"nodeType":"Property","messageId":"missing","endLine":14,"endColumn":43,"fix":{"range":[370,395],"text":"1000,     // 1小时\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":15,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":15,"endColumn":9,"fix":{"range":[386,394],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":17,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":17,"endColumn":9,"fix":{"range":[407,415],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":18,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":18,"endColumn":9,"fix":{"range":[433,441],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":19,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":19,"endColumn":13,"fix":{"range":[460,472],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'oauth_url' is not in camel case.","line":19,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":19,"endColumn":22},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":20,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":20,"endColumn":13,"fix":{"range":[510,522],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'token_url' is not in camel case.","line":20,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":20,"endColumn":22},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":21,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":21,"endColumn":13,"fix":{"range":[560,572],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'userinfo_url' is not in camel case.","line":21,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":21,"endColumn":25},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":22,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":22,"endColumn":13,"fix":{"range":[616,628],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'client_id' is not in camel case.","line":22,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":22,"endColumn":22},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":23,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":23,"endColumn":13,"fix":{"range":[666,678],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'client_secret' is not in camel case.","line":23,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":23,"endColumn":26},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":24,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":24,"endColumn":13,"fix":{"range":[724,736],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'redirect_uri' is not in camel case.","line":24,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":24,"endColumn":25},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":24,"column":55,"nodeType":"Property","messageId":"missing","endLine":25,"endColumn":1,"fix":{"range":[762,788],"text":"GFT_REDIRECT_URI,\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":25,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":25,"endColumn":9,"fix":{"range":[779,787],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":26,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":26,"endColumn":5,"fix":{"range":[790,794],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":28,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":28,"endColumn":5,"fix":{"range":[797,801],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":29,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":29,"endColumn":9,"fix":{"range":[822,830],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":30,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":30,"endColumn":9,"fix":{"range":[843,851],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":31,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":31,"endColumn":13,"fix":{"range":[917,929],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":32,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":32,"endColumn":9,"fix":{"range":[999,1007],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":34,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":34,"endColumn":9,"fix":{"range":[1018,1026],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":34,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":34,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1026,1053],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":35,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":35,"endColumn":5,"fix":{"range":[1054,1058],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":37,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":37,"endColumn":5,"fix":{"range":[1061,1065],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":38,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":38,"endColumn":9,"fix":{"range":[1088,1096],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":39,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":39,"endColumn":9,"fix":{"range":[1150,1158],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":40,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":40,"endColumn":5,"fix":{"range":[1204,1208],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":42,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":42,"endColumn":5,"fix":{"range":[1211,1215],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":43,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":43,"endColumn":9,"fix":{"range":[1241,1249],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":44,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":44,"endColumn":13,"fix":{"range":[1258,1270],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'oauth_url' is not in camel case.","line":44,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":44,"endColumn":22},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":45,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":45,"endColumn":13,"fix":{"range":[1307,1319],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'client_id' is not in camel case.","line":45,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":45,"endColumn":22},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":46,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":46,"endColumn":13,"fix":{"range":[1356,1368],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'redirect_uri' is not in camel case.","line":46,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":46,"endColumn":25},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":47,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":47,"endColumn":13,"fix":{"range":[1411,1423],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":48,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":48,"endColumn":13,"fix":{"range":[1438,1450],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'login_type' is not in camel case.","line":48,"column":13,"nodeType":"Identifier","messageId":"notCamelCase","endLine":48,"endColumn":23},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":48,"column":29,"nodeType":"Property","messageId":"missing","endLine":49,"endColumn":1,"fix":{"range":[1462,1476],"text":"'oa',\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":49,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":49,"endColumn":9,"fix":{"range":[1467,1475],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":50,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":50,"endColumn":5,"fix":{"range":[1478,1482],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":52,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":52,"endColumn":5,"fix":{"range":[1485,1489],"text":"  "}},{"ruleId":"max-lines-per-function","severity":2,"message":"Async method 'authenticate' has too many lines (57). Maximum allowed is 50.","line":52,"column":5,"nodeType":"MethodDefinition","messageId":"exceed","endLine":122,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async method 'authenticate' has too many statements (23). Maximum allowed is 20.","line":52,"column":23,"nodeType":"FunctionExpression","messageId":"exceed","endLine":122,"endColumn":6},{"ruleId":"complexity","severity":2,"message":"Async method 'authenticate' has a complexity of 14. Maximum allowed is 10.","line":52,"column":23,"nodeType":"FunctionExpression","messageId":"complex","endLine":122,"endColumn":6},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":52,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":32},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":53,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":53,"endColumn":9,"fix":{"range":[1520,1528],"text":"    "}},{"ruleId":"no-unused-vars","severity":2,"message":"'state' is assigned a value but never used.","line":53,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":28},{"ruleId":"camelcase","severity":2,"message":"Identifier 'redirect_uri' is not in camel case.","line":53,"column":30,"nodeType":"Identifier","messageId":"notCamelCase","endLine":53,"endColumn":42},{"ruleId":"no-unused-vars","severity":2,"message":"'redirect_uri' is assigned a value but never used.","line":53,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":42},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":55,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":55,"endColumn":9,"fix":{"range":[1585,1593],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":56,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":56,"endColumn":13,"fix":{"range":[1606,1618],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":57,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":57,"endColumn":9,"fix":{"range":[1665,1673],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":59,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":59,"endColumn":9,"fix":{"range":[1684,1692],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":60,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":60,"endColumn":13,"fix":{"range":[1698,1710],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":61,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":61,"endColumn":13,"fix":{"range":[1728,1740],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":62,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":62,"endColumn":17,"fix":{"range":[1767,1783],"text":"        "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'grant_type' is not in camel case.","line":62,"column":17,"nodeType":"Identifier","messageId":"notCamelCase","endLine":62,"endColumn":27},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":63,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":63,"endColumn":17,"fix":{"range":[1803,1819],"text":"        "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'client_id' is not in camel case.","line":63,"column":17,"nodeType":"Identifier","messageId":"notCamelCase","endLine":63,"endColumn":26},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":64,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":64,"endColumn":17,"fix":{"range":[1856,1872],"text":"        "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'client_secret' is not in camel case.","line":64,"column":17,"nodeType":"Identifier","messageId":"notCamelCase","endLine":64,"endColumn":30},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":65,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":65,"endColumn":17,"fix":{"range":[1917,1933],"text":"        "}},{"ruleId":"object-shorthand","severity":2,"message":"Expected property shorthand.","line":65,"column":17,"nodeType":"Property","messageId":"expectedPropertyShorthand","endLine":65,"endColumn":27,"fix":{"range":[1933,1943],"text":"code"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":66,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":66,"endColumn":17,"fix":{"range":[1945,1961],"text":"        "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'redirect_uri' is not in camel case.","line":66,"column":17,"nodeType":"Identifier","messageId":"notCamelCase","endLine":66,"endColumn":29},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":66,"column":58,"nodeType":"Property","messageId":"missing","endLine":67,"endColumn":1,"fix":{"range":[1990,2016],"text":"redirect_uri,\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":67,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":67,"endColumn":13,"fix":{"range":[2003,2015],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":69,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":69,"endColumn":13,"fix":{"range":[2031,2043],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":69,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":69,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2043,2074],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":70,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":70,"endColumn":13,"fix":{"range":[2075,2087],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":71,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":71,"endColumn":17,"fix":{"range":[2172,2188],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":72,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":72,"endColumn":21,"fix":{"range":[2199,2219],"text":"          "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":72,"column":72,"nodeType":"Property","messageId":"missing","endLine":73,"endColumn":1,"fix":{"range":[2235,2288],"text":"'application/x-www-form-urlencoded',\n                }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":73,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":73,"endColumn":17,"fix":{"range":[2271,2287],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":17,"fix":{"range":[2290,2306],"text":"        "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":74,"column":31,"nodeType":"Property","messageId":"missing","endLine":75,"endColumn":1,"fix":{"range":[2315,2334],"text":"10000,\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":75,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":75,"endColumn":13,"fix":{"range":[2321,2333],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":77,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":77,"endColumn":13,"fix":{"range":[2350,2362],"text":"      "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'access_token' is not in camel case.","line":77,"column":21,"nodeType":"Identifier","messageId":"notCamelCase","endLine":77,"endColumn":33},{"ruleId":"camelcase","severity":2,"message":"Identifier 'token_type' is not in camel case.","line":77,"column":35,"nodeType":"Identifier","messageId":"notCamelCase","endLine":77,"endColumn":45},{"ruleId":"camelcase","severity":2,"message":"Identifier 'expires_in' is not in camel case.","line":77,"column":47,"nodeType":"Identifier","messageId":"notCamelCase","endLine":77,"endColumn":57},{"ruleId":"no-unused-vars","severity":2,"message":"'expires_in' is assigned a value but never used.","line":77,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":57},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":78,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":78,"endColumn":13,"fix":{"range":[2431,2443],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":78,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":78,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2443,2469],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":80,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":80,"endColumn":13,"fix":{"range":[2483,2495],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":81,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":81,"endColumn":13,"fix":{"range":[2515,2527],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":82,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":82,"endColumn":17,"fix":{"range":[2595,2611],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":83,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":83,"endColumn":21,"fix":{"range":[2622,2642],"text":"          "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'token_type' is not in camel case.","line":83,"column":41,"nodeType":"Identifier","messageId":"notCamelCase","endLine":83,"endColumn":51},{"ruleId":"camelcase","severity":2,"message":"Identifier 'access_token' is not in camel case.","line":83,"column":67,"nodeType":"Identifier","messageId":"notCamelCase","endLine":83,"endColumn":79},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":83,"column":81,"nodeType":"Property","messageId":"missing","endLine":84,"endColumn":1,"fix":{"range":[2700,2720],"text":"}`,\n                }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":84,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":84,"endColumn":17,"fix":{"range":[2703,2719],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":85,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":85,"endColumn":17,"fix":{"range":[2722,2738],"text":"        "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":85,"column":31,"nodeType":"Property","messageId":"missing","endLine":86,"endColumn":1,"fix":{"range":[2747,2766],"text":"10000,\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":86,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":86,"endColumn":13,"fix":{"range":[2753,2765],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":88,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":88,"endColumn":13,"fix":{"range":[2782,2794],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":90,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":90,"endColumn":13,"fix":{"range":[2843,2855],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":91,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":91,"endColumn":13,"fix":{"range":[2865,2877],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":92,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":92,"endColumn":13,"fix":{"range":[2968,2980],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":93,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":93,"endColumn":13,"fix":{"range":[3061,3073],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":94,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":94,"endColumn":13,"fix":{"range":[3139,3151],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":96,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":96,"endColumn":13,"fix":{"range":[3239,3251],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":97,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":97,"endColumn":17,"fix":{"range":[3279,3295],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":98,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":98,"endColumn":13,"fix":{"range":[3364,3376],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":100,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":100,"endColumn":13,"fix":{"range":[3391,3403],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":100,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":100,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3403,3454],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":102,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":102,"endColumn":13,"fix":{"range":[3468,3480],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":103,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":103,"endColumn":17,"fix":{"range":[3489,3505],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":104,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":104,"endColumn":17,"fix":{"range":[3517,3533],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":105,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":105,"endColumn":17,"fix":{"range":[3549,3565],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":106,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":106,"endColumn":17,"fix":{"range":[3583,3599],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":107,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":107,"endColumn":17,"fix":{"range":[3621,3637],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":108,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":108,"endColumn":17,"fix":{"range":[3650,3666],"text":"        "}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'access_token' is not in camel case.","line":108,"column":17,"nodeType":"Identifier","messageId":"notCamelCase","endLine":108,"endColumn":29},{"ruleId":"object-shorthand","severity":2,"message":"Expected property shorthand.","line":108,"column":17,"nodeType":"Property","messageId":"expectedPropertyShorthand","endLine":108,"endColumn":43,"fix":{"range":[3666,3692],"text":"access_token"}},{"ruleId":"camelcase","severity":2,"message":"Identifier 'access_token' is not in camel case.","line":108,"column":31,"nodeType":"Identifier","messageId":"notCamelCase","endLine":108,"endColumn":43},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":108,"column":43,"nodeType":"Property","messageId":"missing","endLine":109,"endColumn":1,"fix":{"range":[3680,3706],"text":"access_token,\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":109,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":109,"endColumn":13,"fix":{"range":[3693,3705],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":111,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":111,"endColumn":9,"fix":{"range":[3721,3729],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":112,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":112,"endColumn":13,"fix":{"range":[3747,3759],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":112,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":112,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3759,3800],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":113,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":113,"endColumn":13,"fix":{"range":[3801,3813],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":114,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":114,"endColumn":17,"fix":{"range":[3835,3851],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":114,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":114,"endColumn":30,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3851,4063],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":115,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":115,"endColumn":21,"fix":{"range":[3878,3898],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":116,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":116,"endColumn":21,"fix":{"range":[3929,3949],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":117,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":117,"endColumn":21,"fix":{"range":[3988,4008],"text":"          "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":117,"column":56,"nodeType":"Property","messageId":"missing","endLine":118,"endColumn":1,"fix":{"range":[4034,4061],"text":"'unknown',\n                }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":118,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":118,"endColumn":17,"fix":{"range":[4044,4060],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":119,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":119,"endColumn":13,"fix":{"range":[4064,4076],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":120,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":120,"endColumn":13,"fix":{"range":[4078,4090],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":121,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":121,"endColumn":9,"fix":{"range":[4103,4111],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":122,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":122,"endColumn":5,"fix":{"range":[4113,4117],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":124,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":124,"endColumn":5,"fix":{"range":[4120,4124],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":125,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":125,"endColumn":9,"fix":{"range":[4138,4146],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":126,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":126,"endColumn":13,"fix":{"range":[4155,4167],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":127,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":127,"endColumn":17,"fix":{"range":[4169,4185],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":128,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":128,"endColumn":17,"fix":{"range":[4201,4217],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":129,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":129,"endColumn":17,"fix":{"range":[4237,4253],"text":"        "}},{"ruleId":"no-unused-vars","severity":2,"message":"'req' is defined but never used. Allowed unused args must match /^_/u.","line":129,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":36},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":129,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":41},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":130,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":130,"endColumn":21,"fix":{"range":[4284,4304],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":131,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":131,"endColumn":17,"fix":{"range":[4336,4352],"text":"        "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":131,"column":18,"nodeType":"Property","messageId":"missing","endLine":132,"endColumn":1,"fix":{"range":[4352,4367],"text":"},\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":132,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":132,"endColumn":13,"fix":{"range":[4354,4366],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":133,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":133,"endColumn":13,"fix":{"range":[4369,4381],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":134,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":134,"endColumn":17,"fix":{"range":[4383,4399],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":135,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":135,"endColumn":17,"fix":{"range":[4414,4430],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":136,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":136,"endColumn":17,"fix":{"range":[4453,4469],"text":"        "}},{"ruleId":"no-unused-vars","severity":2,"message":"'req' is defined but never used. Allowed unused args must match /^_/u.","line":136,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":136,"endColumn":36},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":136,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":136,"endColumn":41},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":137,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":137,"endColumn":21,"fix":{"range":[4500,4520],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":138,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":138,"endColumn":17,"fix":{"range":[4551,4567],"text":"        "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":138,"column":18,"nodeType":"Property","messageId":"missing","endLine":139,"endColumn":1,"fix":{"range":[4567,4582],"text":"},\n            }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":139,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":139,"endColumn":13,"fix":{"range":[4569,4581],"text":"      "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":139,"column":14,"nodeType":"ObjectExpression","messageId":"missing","endLine":140,"endColumn":1,"fix":{"range":[4581,4592],"text":"},\n        ]"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":140,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":140,"endColumn":9,"fix":{"range":[4583,4591],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":141,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":141,"endColumn":5,"fix":{"range":[4594,4598],"text":"  "}}],"suppressedMessages":[],"errorCount":160,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":128,"fixableWarningCount":0,"source":"const path = require('path');\nconst fs = require('fs').promises;\nconst axios = require('axios');\nconst AuthProvider = require('../../auth-provider');\n\n/**\n * SSO认证提供者\n * 实现企业内部SSO (OAuth2.0) 认证\n */\nclass SSOAuthProvider extends AuthProvider {\n    constructor() {\n        super({\n            maxAge: 12 * 60 * 60 * 1000,      // 12小时\n            maxInactivity: 60 * 60 * 1000     // 1小时\n        });\n        \n        // SSO配置（从环境变量获取）\n        this.ssoConfig = {\n            oauth_url: process.env.GFT_OAUTH_URL,\n            token_url: process.env.GFT_TOKEN_URL,\n            userinfo_url: process.env.GFT_USERINFO_URL,\n            client_id: process.env.GFT_CLIENT_ID,\n            client_secret: process.env.GFT_CLIENT_SECRET,\n            redirect_uri: process.env.GFT_REDIRECT_URI\n        };\n    }\n\n    async initialize() {\n        // 验证必要的环境变量\n        if (!this.ssoConfig.client_id || !this.ssoConfig.client_secret) {\n            throw new Error('缺少必要的SSO配置环境变量 (GFT_CLIENT_ID, GFT_CLIENT_SECRET)');\n        }\n        \n        console.log('✅ SSO配置验证通过');\n    }\n\n    async getLoginPage() {\n        const loginPath = path.join(__dirname, 'login.html');\n        return await fs.readFile(loginPath, 'utf-8');\n    }\n\n    async getClientConfig() {\n        return {\n            oauth_url: this.ssoConfig.oauth_url,\n            client_id: this.ssoConfig.client_id,\n            redirect_uri: this.ssoConfig.redirect_uri,\n            theme: 'mini',\n            login_type: 'oa'\n        };\n    }\n\n    async authenticate(req, res) {\n        const { code, state, redirect_uri } = req.body;\n        \n        if (!code) {\n            throw new Error('Missing authorization code');\n        }\n        \n        try {\n            // 第一步：用认证码换取访问令牌\n            const tokenRequestData = {\n                grant_type: 'code',\n                client_id: this.ssoConfig.client_id,\n                client_secret: this.ssoConfig.client_secret,\n                code: code,\n                redirect_uri: this.ssoConfig.redirect_uri\n            };\n            \n            console.log('🔄 开始SSO认证流程...');\n            const tokenResponse = await axios.post(this.ssoConfig.token_url, tokenRequestData, {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                },\n                timeout: 10000\n            });\n            \n            const { access_token, token_type, expires_in } = tokenResponse.data;\n            console.log('✅ 获取访问令牌成功');\n            \n            // 第二步：使用访问令牌获取用户信息\n            const userResponse = await axios.get(this.ssoConfig.userinfo_url, {\n                headers: {\n                    'Authorization': `${token_type || 'Bearer'} ${access_token}`\n                },\n                timeout: 10000\n            });\n            \n            const userInfo = userResponse.data;\n            \n            // 解析用户信息\n            const userId = userInfo.access_token?.user_id || userInfo.oa?.uid || userInfo.oa?.loginid;\n            const userName = userInfo.oa?.sn || userInfo.oa?.cn || userInfo.oa?.displayname;\n            const userEmail = userInfo.oa?.email || userInfo.oa?.mailaddress;\n            const userDept = userInfo.oa?.['fdu-deptname'] || userInfo.oa?.dpfullname;\n            \n            if (!userId || !userName) {\n                throw new Error(`用户信息解析失败: userId=${userId}, userName=${userName}`);\n            }\n            \n            console.log(`✅ 获取用户信息成功: ${userName} (${userId})`);\n            \n            return {\n                id: userId,\n                name: userName,\n                email: userEmail,\n                department: userDept,\n                type: 'sso',\n                access_token: access_token\n            };\n            \n        } catch (error) {\n            console.error('SSO认证失败:', error.message);\n            if (error.response) {\n                console.error('HTTP错误:', {\n                    status: error.response.status,\n                    statusText: error.response.statusText,\n                    url: error.config?.url || 'unknown'\n                });\n            }\n            throw error;\n        }\n    }\n\n    getRoutes() {\n        return [\n            {\n                method: 'post',\n                path: '/login/sso',\n                handler: async (req, res) => {\n                    // SSO认证由AuthManager统一处理，这里只是占位\n                }\n            },\n            {\n                method: 'get',\n                path: '/login/config',\n                handler: async (req, res) => {\n                    // 配置获取由AuthManager统一处理，这里只是占位\n                }\n            }\n        ];\n    }\n}\n\nmodule.exports = SSOAuthProvider;","usedDeprecatedRules":[{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/zhibinpan/workspace/coc/login/server.js","messages":[{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":26,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":26,"endColumn":5,"fix":{"range":[669,673],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":27,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":27,"endColumn":9,"fix":{"range":[679,687],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":28,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":28,"endColumn":9,"fix":{"range":[719,727],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":28,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":28,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[727,777],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":29,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":29,"endColumn":5,"fix":{"range":[778,782],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":30,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":30,"endColumn":9,"fix":{"range":[800,808],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":30,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":30,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[808,853],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":31,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":31,"endColumn":9,"fix":{"range":[854,862],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":32,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":32,"endColumn":5,"fix":{"range":[879,883],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":43,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":43,"endColumn":5,"fix":{"range":[1170,1174],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":5,"fix":{"range":[1217,1221],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":45,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":45,"endColumn":9,"fix":{"range":[1289,1297],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":46,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":46,"endColumn":9,"fix":{"range":[1315,1323],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":47,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":47,"endColumn":5,"fix":{"range":[1378,1382],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":48,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":48,"endColumn":9,"fix":{"range":[1391,1399],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":49,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":49,"endColumn":9,"fix":{"range":[1410,1418],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":50,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":50,"endColumn":5,"fix":{"range":[1458,1462],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":58,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":58,"endColumn":5,"fix":{"range":[1605,1609],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":59,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":59,"endColumn":5,"fix":{"range":[1642,1646],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":60,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":60,"endColumn":5,"fix":{"range":[1666,1670],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":61,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":61,"endColumn":5,"fix":{"range":[1697,1701],"text":"  "}},{"ruleId":"comma-dangle","severity":2,"message":"Missing trailing comma.","line":61,"column":21,"nodeType":"Property","messageId":"missing","endLine":62,"endColumn":1,"fix":{"range":[1711,1719],"text":"'info',\n}"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":69,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":69,"endColumn":5,"fix":{"range":[1809,1813],"text":"  "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":69,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":69,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1813,1865],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":70,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":70,"endColumn":5,"fix":{"range":[1866,1870],"text":"  "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":70,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":70,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1870,1910],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":72,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":72,"endColumn":5,"fix":{"range":[1916,1920],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":73,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":73,"endColumn":9,"fix":{"range":[1952,1960],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":73,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":73,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1960,1988],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":9,"fix":{"range":[1989,1997],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":74,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":74,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1997,2029],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":75,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":75,"endColumn":9,"fix":{"range":[2030,2038],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":75,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":75,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2038,2084],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":76,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":76,"endColumn":5,"fix":{"range":[2085,2089],"text":"  "}}],"suppressedMessages":[],"errorCount":27,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":27,"fixableWarningCount":0,"source":"const path = require('path');\n\n// 加载环境变量（从当前目录的.env文件）\nrequire('dotenv').config({ path: path.join(__dirname, '.env') });\n\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst cookieParser = require('cookie-parser');\nconst { createProxyMiddleware } = require('http-proxy-middleware');\nconst AuthManager = require('./auth-manager');\n\nconst app = express();\nconst port = 3000;\n\n// 中间件配置\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// 初始化认证管理器\nconst authProvider = process.env.AUTH_PROVIDER || 'sso';\nconst authManager = new AuthManager(authProvider);\n\n// 启动认证管理器\n(async () => {\n    try {\n        await authManager.initialize();\n        console.log(`✅ 认证系统初始化完成，使用提供者: ${authProvider}`);\n    } catch (error) {\n        console.error('❌ 认证系统初始化失败:', error.message);\n        process.exit(1);\n    }\n})();\n\n// 认证相关路由\napp.get('/login', authManager.getLoginHandler());\napp.get('/login/config', authManager.getConfigHandler());\napp.post('/logout', authManager.getLogoutHandler());\n\n// 动态注册认证提供者的路由\nconst providerRoutes = authManager.getProviderRoutes();\nproviderRoutes.forEach(route => {\n    const method = route.method.toLowerCase();\n    if (route.path === '/login/sso' || route.path === '/login/local') {\n        // 这些路由使用统一的认证处理器\n        app[method](route.path, authManager.getAuthHandler());\n    } else {\n        // 其他自定义路由\n        app[method](route.path, route.handler);\n    }\n});\n\n// 认证中间件（必须在认证路由之后）\napp.use(authManager.getMiddleware());\n\n// 创建简单的ttyd代理 - 认证成功后，所有请求代理到ttyd\nconst ttydProxy = createProxyMiddleware({\n    target: 'http://127.0.0.1:7681',\n    changeOrigin: true,\n    ws: true, // 自动处理WebSocket\n    logLevel: 'info'\n});\n\n// 所有请求都代理到ttyd（已通过认证中间件）\napp.use('/', ttydProxy);\n\n// 启动服务器\napp.listen(port, () => {\n    console.log(`🚀 登录服务器运行在 http://localhost:${port}`);\n    console.log(`🔐 认证模式: ${authProvider}`);\n    \n    if (authProvider === 'local') {\n        console.log('📝 本地开发模式提示:');\n        console.log('   - 使用任意用户名密码登录');\n        console.log('   - 生产环境请设置 AUTH_PROVIDER=sso');\n    }\n});","usedDeprecatedRules":[{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]
